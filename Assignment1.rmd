---
title: "Assignment1"
output: github_document
---

# Homework Assignment 1 


```{r}
data<-read.csv("/Users/jackielindstrom/Documents/ClinicalTrialsHW/ClinicalTrials/homework1data.csv")
```

```{r}
head(data)
```

```{r}
dim(data)
```

```{r}
qnorm(0.70)
```
## Question 2:
# Power = 0.9
```{r}
power.t.test(delta=5, sd=8, sig.level=0.05, power=0.9, type="two.sample", alternative = "two.sided", strict=FALSE)
```
# Power = 0.8
```{r}
power.t.test(delta=5, sd=8, sig.level=0.05, power=0.8, type="two.sample", alternative = "two.sided", strict=FALSE)
```
# Power = 0.7
```{r}
power.t.test(delta=5, sd=8, sig.level=0.05, power=0.7, type="two.sample", alternative = "two.sided", strict=FALSE)
```

# Question 3:
##In R, compute the unadjusted estimator, , for the average treatment effect𝑌1 − 𝑌0
##using the data. Then construct its 95% confidence interval. Write down the R
##code and results. What is your conclusion?

```{r}
treat_mean<-mean(data$CDRSR_week12[data$treatment == 1])
none_mean<-mean(data$CDRSR_week12[data$treatment == 0])

diff<-treat_mean-none_mean
print(diff)
print(treat_mean)
print(none_mean)
```

# CI Calculation
```{r}
n1<-sum(data$treatment == 1)
n0<-sum(data$treatment == 0)
y1 <- data$CDRSR_week12[data$treatment == 1]
y0 <- data$CDRSR_week12[data$treatment == 0]
delta_hat<-mean(y1)-mean(y0)
var_hat<-(var(y1)/n1)+(var(y0)/n0)
c(delta_hat-1.96*sqrt(var_hat), delta_hat+1.96*sqrt(var_hat))
```

# Checking work
```{r}
t_test <- t.test(CDRSR_week12 ~ treatment, data = data, var.equal = TRUE) 
t_test$estimate   
t_test$conf.int
```

# 4 
## ANCOVA model to compute the adjusted estimator for the average treatment effect

```{r}
ancova_model<-lm(CDRSR_week12 ~ treatment + CDRSR_baseline, data = data)
summary(ancova_model)
```

```{r}
coef(ancova_model)["treatment"]
confint(ancova_model, "treatment", level = 0.95)
```

# 5
## Binary outcome Equation

# CHECK
```{r}
data$reduced <- ifelse(data$CDRSR_baseline - data$CDRSR_week12 >= 5, 1, 0)
head(data)
```

```{r}
treat_mean_b<-mean(data$reduced[data$treatment == 1])
none_mean_b<-mean(data$reduced[data$treatment == 0])

diff_b<- none_mean_b-treat_mean_b

print(diff_b)
```
```{r}
t_test <- t.test(reduced ~ treatment, data = data, var.equal = TRUE) 
t_test$estimate   #means for each group, need to subtract
t_test$conf.int
```

# 6 
```{r}
ratio<-treat_mean_b/none_mean_b
print(ratio)
```